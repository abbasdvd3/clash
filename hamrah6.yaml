# profile-title: base64:Ym94LUFiYmFzZHZkMTDwn5Om2YfZhdmHINqG24wg2K/YsdmI2LrZhw==
# profile-update-interval: 1
# subscription-userinfo: upload=7000000; download=500000; total=10737418240000000; expire=2546249531
# support-url: https://github.com/abbasdvd3
# profile-web-page-url: https://github.com/abbasdvd3
# Traffic consumption device: https://db2.laomoe.com/  
# Current IP: https://api.leyz.top/ip/


port: 7892
socks-port: 7891
mixed-port: 7890
allow-lan: true
# mode: Rule
bind-address: "*"
ipv6: true
log-level: info
find-process-mode: always
enable-process: true
unified-delay: true
keep-alive-interval: 15
tcp-concurrent: true
geodata-mode: true

external-controller: 0.0.0.0:9090
external-ui: ui
external-ui-url: "https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip"
global-client-fingerprint: chrome


dns:
  enable: true
  listen: 0.0.0.0:1053
  ipv6: false
  default-nameserver:
    - 114.114.114.114:53
    - 180.76.76.76:53
    - 119.29.29.29:53
    - 223.5.5.5:53
    - 8.8.8.8:53
    - 8.8.4.4:53
    - 1.1.1.1:53
    - 1.0.0.1:53
  nameserver:
    - 114.114.114.114
    - 180.76.76.76:53
    - 119.29.29.29:53
    - 223.5.5.5:53
    - 8.8.8.8:53
    - 8.8.4.4:53
    - 1.1.1.1:53
    - 1.0.0.1:53
  enhanced-mode: redir-host
  fake-ip-range: 100.10.0.0/16
  fake-ip-filter:
    - "*.lan"

tun:
  enable: true
  stack: system
  auto-route: true
  auto-detect-interface: true
  dns-hijack:
    - 114.114.114.114
    - 180.76.76.76
    - 119.29.29.29
    - 223.5.5.5
    - 8.8.8.8
    - 8.8.4.4
    - 1.1.1.1
    - 1.0.0.1

profile:
  store-fake-ip: true
  store-selected: true
  tracing: true

proxies:
  - name: IRAN
    type: direct
    server: 0.0.0.0
    port: 10811
    udp: false
proxy-groups:
  - name: Proxy
    type: select
    use: 
    proxies:
      - Auto
      - fallback
      - Geo-US

  - name: Auto
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 100
    lazy: true
    use: 
      - Subscription-1
      - Subscription-2
      - Subscription-3
      - Subscription-4
      - Subscription-5
      - Subscription-6
      - Subscription-7
      
  - name: fallback
    type: fallback
    url: http://www.gstatic.com/generate_204
    interval: 180
    lazy: true
    use:
      - Subscription-1
      - Subscription-2
      - Subscription-3
      - Subscription-4
      - Subscription-5
      - Subscription-6
      - Subscription-7
      
  - name: Geo-SG
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 100
    lazy: true
    filter: "HongKong|HK|香港|Singapore|SG|新加坡Taiwan|TW|台湾|Germany|Deutsch|DE|德国"
    use: 
      - Subscription-1
      - Subscription-2
      - Subscription-3
      - Subscription-4
      - Subscription-5
      - Subscription-6
      - Subscription-7
      
  - name: Geo-JP
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 100
    lazy: true
    filter: "Japan|JP|日本"
    use: 
      - Subscription-1
      - Subscription-2
      - Subscription-3
      - Subscription-4
      - Subscription-5
      - Subscription-6
      - Subscription-7
      
  - name: Geo-US
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 100
    lazy: true
    filter: "America|United States|US|美国"
    use: 
      - Subscription-1
      - Subscription-2
      - Subscription-3
      - Subscription-4
      - Subscription-5
      - Subscription-6
      - Subscription-7
      
  - name: Geo-CN
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 100
    lazy: true
    filter: "China|CN|中国"
    use: 
      - Subscription-7
      - Subscription-6
      - Subscription-5
      - Subscription-4
      - Subscription-3
      - Subscription-2
      - Subscription-1
 
  - name: Social
    type: url-test
    use: 
      - Subscription-7
      - Subscription-6
      - Subscription-5
      - Subscription-4
      - Subscription-3
      - Subscription-2
      - Subscription-1
    proxies: 
      - Proxy
      - Auto

  - name: IR
    type: select
    disable-dns: true
    use: 
    proxies: 
      - IRAN
      - Proxy
  - name: global
    type: select
    udp: true
    use: 
    proxies: 
      - Proxy
      - Auto
      - fallback

proxy-providers:
  Subscription-1:
    type: http
    url: "https://raw.githubusercontent.com/NiceVPN123/NiceVPN/main/Clash.yaml" 
    path: providers6/Subscription-1.yaml
    proxies: DIRECT
    interval: 600
    health-check:
      enable: true
      interval: 300
      url: https://t1.geigei.gq
      lazy: true 

  Subscription-2:
    type: http
    url: "https://raw.githubusercontent.com/abbasdvd3/clash/main/vless/x" 
    path: providers6/Subscription-2.yaml
    proxies: DIRECT
    interval: 600
    health-check:
      enable: true
      interval: 300
      url: https://t1.geigei.gq
      lazy: true 

  Subscription-3:
    type: http
    url: "https://raw.githubusercontent.com/anaer/Sub/main/clash.yaml"
    path: providers6/Subscription-3.yaml
    proxies: DIRECT
    interval: 600
    health-check:
      enable: true
      interval: 300
      url: https://t1.geigei.gq
      lazy: true 

  Subscription-4:
    type: http
    url: "https://raw.githubusercontent.com/mahdibland/V2RayAggregator/master/sub/sub_merge_yaml.yml" 
    path: providers6/Subscription-4.yaml
    proxies: DIRECT
    interval: 600
    health-check:
      enable: true
      interval: 300
      url: https://t1.geigei.gq
      lazy: true 

  Subscription-5:
    type: http
    url: "https://raw.githubusercontent.com/ronghuaxueleng/get_v2/main/pub/combine.yaml" 
    path: providers6/Subscription-5.yaml
    proxies: DIRECT
    interval: 600
    health-check:
      enable: true
      interval: 300
      url: https://t1.geigei.gq
      lazy: true 

  Subscription-6:
    type: http
    url: "https://raw.githubusercontent.com/chengaopan/AutoMergePublicNodes/master/list.yml" 
    path: providers6/Subscription-6.yaml
    proxies: DIRECT
    interval: 600
    health-check:
      enable: true
      interval: 300
      url: https://t1.geigei.gq
      lazy: true 

  Subscription-7:
    type: http
    url: "https://raw.githubusercontent.com/dongchengjie/airport/main/subs/merged/tested_within.yaml" 
    path: providers6/Subscription-7.yaml
    proxies: DIRECT
    interval: 600
    health-check:
      enable: true
      interval: 300
      url: https://t1.geigei.gq
      lazy: true 

rule-providers:
  ir:
    type: http
    format: yaml
    behavior: domain
    url: "https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/ir.yaml"
    path: ruleset/ir.yaml
    interval: 86400
  apps:
    type: http
    format: yaml
    behavior: classical
    url: "https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/apps.yaml"
    path: ruleset/apps.yaml
    interval: 86400
  ircidr:
    type: http
    format: yaml
    behavior: ipcidr
    url: "https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/ircidr.yaml"
    path: ruleset/ircidr.yaml
    interval: 86400
  private:
    type: http
    format: yaml
    behavior: ipcidr
    url: "https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/private.yaml"
    path: ruleset/private.yaml
    interval: 86400
  irasn:
    type: http
    format: yaml
    behavior: classical
    url: "https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/irasn.yaml"
    path: ruleset/irasn.yaml
    interval: 86400
rules:
  - GEOIP,IR,IR
  - GEOIP,private,IR,no-resolve
  - RULE-SET,private,IR,no-resolve
  - RULE-SET,apps,IR
  - RULE-SET,ir,IR
  - RULE-SET,irasn,IR
  - RULE-SET,ircidr,IR
  - DOMAIN-SUFFIX,msftconnecttest.com,DIRECT
  - DOMAIN-SUFFIX,v2rayse.com,Proxy
  - DOMAIN-SUFFIX,cff.pw,Proxy
  - DOMAIN-SUFFIX,vpnse.org,global
  - DOMAIN-SUFFIX,cfmem.com,global
  - DOMAIN-SUFFIX,googlesyndication.com,Proxy,no-resolve
  - AND,((GEOSITE,category-ads-all),(NOT,((DOMAIN-SUFFIX,googlesyndication.com)))),REJECT
  - AND,((NETWORK,udp),(OR,((DST-PORT,443/80),(GEOSITE,youtube)))),REJECT
  - AND,((NETWORK,udp),(GEOSITE,youtube)),REJECT
  - IP-CIDR,127.0.0.1/32,REJECT,no-resolve
  - IP-CIDR,198.18.0.1/16,REJECT,no-resolve
  - IP-CIDR,28.0.0.1/8,REJECT,no-resolve
  - IP-CIDR6,::1/128,REJECT,no-resolve
  - AND,((PROCESS-NAME,clash),(NOT,((IN-TYPE,inner)))),REJECT
  - PROCESS-NAME,com.sec.location.nsflp2,REJECT
  - PROCESS-NAME,com.samsung.android.location,REJECT
  - PROCESS-NAME,com.android.localtransport,REJECT
  - PROCESS-NAME,com.google.android.gms.location.history,REJECT
  - PROCESS-NAME,com.sec.location.nsflp2,REJECT
  - PROCESS-NAME,com.android.location.fused,REJECT
  - PROCESS-NAME,org.telegram.messenger,global,no-resolve
  - PROCESS-NAME,com.tumblr,global,no-resolve
  - PROCESS-NAME,com.google.android.webview:sandboxed_process0:org.chromium.content.app.SandboxedProcessService0:0,global,no-resolve
  - PROCESS-NAME,com.tumblr/org.chromium.content.app.SandboxedProcessService0:0,global,no-resolve
  - PROCESS-NAME,com.google.android.gms,global,no-resolve
  - PROCESS-NAME,com.google.android.webview,global,no-resolve
  - PROCESS-NAME,com.android.vending,global,no-resolve
  - PROCESS-NAME,com.google.android.gm,global,no-resolve
  - PROCESS-NAME,com.picsart.studio,global,no-resolve
  - PROCESS-NAME,com.tomclaw.appsend,global,no-resolve
  - PROCESS-NAME,com.photoroom.app,global,no-resolve
  - PROCESS-NAME,com.frontrow.flow,global,no-resolve
  - PROCESS-NAME,com.xt.retouchoversea,global,no-resolve
  - PROCESS-NAME,com.prequel.app,global,no-resolve
  - PROCESS-NAME,com.circular.pixels,global,no-resolve
  - PROCESS-NAME,jp.pxv.android,global,no-resolve
  - PROCESS-NAME,com.facebook.katana,global,no-resolve
  - PROCESS-NAME,com.facebook.katanb,global,no-resolve
  - PROCESS-NAME,com.discord,global,no-resolve
  - PROCESS-NAME,com.twitter.plus,global,no-resolve
  - PROCESS-NAME,com.twitter.android,global,no-resolve
  - PROCESS-NAME,com.aeroinsta.android,global,no-resolve
  - PROCESS-NAME,com.instagold.android,global,no-resolve
  - PROCESS-NAME,com.instathunder.android,global,no-resolve
  - PROCESS-NAME,com.myinsta.android,global,no-resolve
  - PROCESS-NAME,com.instagram.android,global,no-resolve
  - DST-PORT,80/8080/443/8443,Proxy,no-resolve
  - PROCESS-NAME,com.tomclaw.appsend,DIRECT
  - DOMAIN-SUFFIX,appteka.store,DIRECT
  - DOMAIN-SUFFIX,appteka.store/api,DIRECT
  - MATCH,global
