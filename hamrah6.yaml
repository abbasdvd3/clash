# profile-title: base64:Ym94LUFiYmFzZHZkMTDwn5Om2YfZhdmHINqG24wg2K/YsdmI2LrZhw==
# profile-update-interval: 1
# subscription-userinfo: upload=7000000; download=500000; total=10737418240000000; expire=2546249531
# support-url: https://github.com/abbasdvd3
# profile-web-page-url: https://github.com/abbasdvd3
# Traffic consumption device: https://db2.laomoe.com/  
# Current IP: https://api.leyz.top/ip/

port: 7892
socks-port: 7891
mixed-port: 7890
redir-port: 9797
tproxy-port: 9898
allow-lan: true
mode: Rule
bind-address: "*"
ipv6: true
log-level: info
find-process-mode: always
enable-process: true
unified-delay: true
keep-alive-interval: 15
tcp-concurrent: true
geodata-mode: true
external-controller: 0.0.0.0:9090
external-ui: ui
external-ui-url: "https://github.com/Zephyruso/zashboard/releases/latest/download/dist.zip"
global-client-fingerprint: chrome
dns:
  enable: true
  prefer-h3: false
  listen: 0.0.0.0:1053
  ipv6: true
  ipv6-timeout: 300
  respect-rules: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  use-hosts: true
  fake-ip-filter:
    - '*.lan'
    - '*.local'
    - 'localhost.ptlogin2.qq.com'
    - '+.srv.nintendo.net'
    - '+.stun.playstation.net'
    - 'xbox.*.microsoft.com'
    - '+.xboxlive.com'
    - '+.stun.*.*'
    - '+.stun.*.*.*'
    - '+.stun.*.*.*.*'
    - '+.stun.*.*.*.*.*'
    - '*.lan'
    - 'speedtest.cros.wr.pvp.net'
  default-nameserver:
    - 119.29.29.29
    - 223.6.6.6
  direct-nameserver:
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query
  direct-nameserver-follow-policy: true
  proxy-server-nameserver:
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query
  nameserver:
    - https://dns.cloudflare.com/dns-query
    - https://dns.google/dns-query
  nameserver-policy:
    "rule-set:social,nsfw,geolocation-!cn":
      - https://doh.pub/dns-query
      - https://dns.alidns.com/dns-query
    "rule-set:ir":
      - system

tun:
  enable: true
  stack: mixed
  device: tun0
  dns-hijack:
    - "any:53"
    - "tcp://any:53"
  auto-route: true
  auto-redirect: false
  auto-detect-interface: true

profile:
  store-fake-ip: true
  store-selected: true
  tracing: true

proxies:
  - name: IRAN
    type: direct
    server: 0.0.0.0
    port: 10811
    udp: false
proxy-groups:
  - name: Proxy
    type: select
    include-all-providers: true
    hidden: true
    proxies:
      - Auto
      - fallback
      - Geo-US
  - name: Auto
    type: url-test
    url: https://t1.geigei.gq/generate_204
    include-all-providers: true
    hidden: true
    interval: 100
    exclude-type: "direct|redir-in|DNS"
    filter: "America|United States|US|美国"
    lazy: true

  - name: fallback
    type: fallback
    url: https://t1.geigei.gq/generate_204
    include-all-providers: true
    exclude-type: "direct|redir-in|DNS"
    hidden: true
    interval: 180
    filter: "America|United States|US|美国"
    lazy: true

  - name: Geo-SG
    type: url-test
    url: https://t1.geigei.gq/generate_204
    include-all-providers: true
    exclude-type: "direct|redir-in|DNS"
    hidden: true
    interval: 100
    lazy: true
    filter: "HongKong|HK|香港|Singapore|SG|新加坡Taiwan|TW|台湾|Germany|Deutsch|DE|德国"
    use: 
  - name: Geo-JP
    type: url-test
    url: https://t1.geigei.gq/generate_204
    exclude-type: "direct|redir-in|DNS"
    include-all-providers: true
    hidden: true
    interval: 100
    lazy: true
    filter: "Japan|JP|日本"

  - name: Geo-US
    type: url-test
    url: https://t1.geigei.gq/generate_204
    exclude-type: "direct|redir-in|DNS"
    include-all-providers: true
    hidden: true
    interval: 100
    lazy: true
    filter: "America|United States|US|美国"
 
  - name: Geo-CN
    type: url-test
    url: https://t1.geigei.gq/generate_204
    exclude-type: "direct|redir-in|DNS"
    include-all-providers: true
    hidden: true
    interval: 100
    lazy: true
    filter: "China|CN|中国"
  
  - name: Social
    type: url-test
    hidden: true
    proxies: 
      - Proxy
      - Auto
  - name: IR
    type: select
    disable-dns: true
    proxies: 
      - IRAN
      - Proxy

proxy-providers:
  Subscription-1:
    type: http
    url: "https://raw.githubusercontent.com/NiceVPN123/NiceVPN/main/Clash.yaml"
    proxies: DIRECT
    interval: 600
    health-check:
      enable: true
      interval: 300
      url: https://t1.geigei.gq/generate_204
      lazy: true 

  Subscription-2:
    type: http
    url: "https://raw.githubusercontent.com/abbasdvd3/clash/main/vless/x"
    proxies: DIRECT
    interval: 600
    health-check:
      enable: true
      interval: 300
      url: https://t1.geigei.gq/generate_204
      lazy: true 

  Subscription-3:
    type: http
    url: "https://raw.githubusercontent.com/anaer/Sub/main/clash.yaml"
    proxies: DIRECT
    interval: 600
    health-check:
      enable: true
      interval: 300
      url: https://t1.geigei.gq/generate_204
      lazy: true 

  Subscription-4:
    type: http
    url: "https://raw.githubusercontent.com/mahdibland/V2RayAggregator/master/sub/sub_merge_yaml.yml"
    proxies: DIRECT
    interval: 600
    health-check:
      enable: true
      interval: 300
      url: https://t1.geigei.gq/generate_204
      lazy: true 

  Subscription-5:
    type: http
    url: "https://raw.githubusercontent.com/ronghuaxueleng/get_v2/main/pub/combine.yaml"
    proxies: DIRECT
    interval: 600
    health-check:
      enable: true
      interval: 300
      url: https://t1.geigei.gq/generate_204
      lazy: true 

  Subscription-6:
    type: http
    url: "https://raw.githubusercontent.com/chengaopan/AutoMergePublicNodes/master/list.yml"
    proxies: DIRECT
    interval: 600
    health-check:
      enable: true
      interval: 300
      url: https://t1.geigei.gq/generate_204
      lazy: true 

  Subscription-7:
    type: http
    url: "https://raw.githubusercontent.com/dongchengjie/airport/main/subs/merged/tested_within.yaml"
    proxies: DIRECT
    interval: 600
    health-check:
      enable: true
      interval: 300
      url: https://t1.geigei.gq/generate_204
      lazy: true 

rule-providers:
  nsfw:
    type: http
    format: yaml
    behavior: domain
    url: "https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/nsfw.yaml"
    interval: 30
  social:
    type: http
    format: yaml
    behavior: domain
    url: "https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/social.yaml"
    interval: 30
  ads:
    type: http
    format: yaml
    behavior: domain
    url: "https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/ads.yaml"
    interval: 86400
  malware:
    type: http
    format: yaml
    behavior: domain
    url: "https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/malware.yaml"
    interval: 86400
  phishing:
    type: http
    format: yaml
    behavior: domain
    url: "https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/phishing.yaml"
    interval: 86400
  cryptominers:
    type: http
    format: yaml
    behavior: domain
    url: "https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/cryptominers.yaml"
    interval: 86400
  geolocation-!cn:
    type: http
    format: yaml
    behavior: domain
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/geolocation-!cn.yaml"
    interval: 86400
  ir:
    type: http
    format: yaml
    behavior: domain
    url: "https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/ir.yaml"
    interval: 86400
  apps:
    type: http
    format: yaml
    behavior: classical
    url: "https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/apps.yaml"
    interval: 86400
  ircidr:
    type: http
    format: yaml
    behavior: ipcidr
    url: "https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/ircidr.yaml"
    interval: 86400
  private:
    type: http
    format: yaml
    behavior: ipcidr
    url: "https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/private.yaml"
    interval: 86400
  irasn:
    type: http
    format: yaml
    behavior: classical
    url: "https://raw.githubusercontent.com/Chocolate4U/Iran-clash-rules/release/irasn.yaml"
    interval: 86400
rules:
  - RULE-SET,ads,REJECT
  - RULE-SET,malware,REJECT
  - RULE-SET,phishing,REJECT
  - RULE-SET,cryptominers,REJECT
  - RULE-SET,social,Proxy,no-resolve
  - RULE-SET,nsfw,Proxy,no-resolve
  - RULE-SET,geolocation-!cn,Proxy
  - GEOIP,IR,IR
  - GEOIP,private,IR,no-resolve
  - RULE-SET,private,IR,no-resolve
  - RULE-SET,apps,IR
  - RULE-SET,ir,IR
  - RULE-SET,irasn,IR
  - RULE-SET,ircidr,IR
  - AND,((GEOSITE,category-ads-all),(NOT,((DOMAIN-SUFFIX,googlesyndication.com)))),REJECT
  - AND,((NETWORK,udp),(OR,((DST-PORT,443/80),(GEOSITE,youtube)))),REJECT
  - AND,((NETWORK,udp),(GEOSITE,youtube)),REJECT
  - MATCH,Proxy
