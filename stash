# content-disposition: attachment; filename="stash.yaml"
# subscription-userinfo: upload=1234; download=2234; total=1024000; expire=2218532293
# profile-update-interval: 24
# profile-web-page-url: 

ipv6: true
allow-lan: true
mixed-port: 7890
external-controller: 127.0.0.1:9090
profile:
  store-selected: true
  store-fake-ip: true
dns:
  enable: true
  ipv6: true
  enhanced-mode: fake-ip
  use-system-hosts: false
  cache-algorithm: arc
  fake-ip-filter:
    - "*"
    - "+.lan"
    - "+.local"
  default-nameserver:
    - https://1.1.1.1/dns-query
    - https://1.0.0.1/dns-query
    - https://208.67.222.222/dns-query
    - https://208.67.220.220/dns-query
    - https://194.242.2.2/dns-query
    - https://194.242.2.3/dns-query
  nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query
    - https://doh.360.cn/dns-query
    - quic://dns.adguard.com:784
hosts:
  '*.clash.dev': 127.0.0.1
  'alpha.clash.dev': '::1'

######### é”šç‚¹ start #######
# ç­–ç•¥ç»„ç›¸å…³
pr: &pr {type: select, proxies: [é»˜è®¤, é¦™æ¸¯, hok, å°æ¹¾, ta, æ—¥æœ¬, ja, æ–°åŠ å¡, singapore, ç¾å›½, states, å…¶å®ƒåœ°åŒº, å…¨éƒ¨èŠ‚ç‚¹, è‡ªåŠ¨é€‰æ‹©, ç›´è¿]}
#è¿™é‡Œæ˜¯è®¢é˜…æ›´æ–°å’Œå»¶è¿Ÿæµ‹è¯•ç›¸å…³çš„
p: &p {type: http, interval: 360, health-check: {enable: true, url: "https://www.gstatic.com/generate_204", interval: 3}}
######### é”šç‚¹ end #######

  
# url é‡Œå¡«å†™è‡ªå·±çš„è®¢é˜…,åç§°ä¸èƒ½é‡å¤
proxy-providers:
  provider1:
    <<: *p
    url: "https://raw.githubusercontent.com/abbasdvd3/clash/main/vless/r"
    path: "stash/provider1.yaml"
  provider2:
    <<: *p
    url: "https://raw.githubusercontent.com/AzadNetCH/Clash/main/AzadNet_META_IRAN-Direct.yml"
    path: "stash/provider2.yaml"
FilterHK: &FilterHK '^(?=.*((?i)ğŸ‡­ğŸ‡°|é¦™æ¸¯|(\b(HK|Hong)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$'
FilterTW: &FilterTW '^(?=.*((?i)ğŸ‡¹ğŸ‡¼|å°æ¹¾|(\b(TW|Tai|Taiwan)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$'
FilterJP: &FilterJP '^(?=.*((?i)ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|(\b(JP|Japan)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$'
FilterKR: &FilterKR '^(?=.*((?i)ğŸ‡°ğŸ‡·|éŸ©å›½|éŸ“|é¦–å°”|(\b(KR|Korea)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$'
FilterSG: &FilterSG '^(?=.*((?i)ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®|(\b(SG|Singapore)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$'
FilterUS: &FilterUS '^(?=.*((?i)ğŸ‡ºğŸ‡¸|ç¾å›½|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’å†ˆ|å‡¤å‡°åŸ|è´¹åˆ©è’™|ç¡…è°·|æ‹‰æ–¯ç»´åŠ æ–¯|æ´›æ‰çŸ¶|åœ£ä½•å¡|åœ£å…‹æ‹‰æ‹‰|è¥¿é›…å›¾|èŠåŠ å“¥|(\b(US|United States)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$'
FilterUK: &FilterUK '^(?=.*((?i)ğŸ‡¬ğŸ‡§|è‹±å›½|ä¼¦æ•¦|(\b(UK|United Kingdom)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$'
FilterFR: &FilterFR '^(?=.*((?i)ğŸ‡«ğŸ‡·|æ³•å›½|(\b(FR|France)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$'
FilterDE: &FilterDE '^(?=.*((?i)ğŸ‡©ğŸ‡ª|å¾·å›½|(\b(DE|Germany)\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$'
FilterGame: &FilterGame '^(?=.*((?i)æ¸¸æˆ|ğŸ®|(\b(GAME)\b)))(?!.*((?i)å›å›½|æ ¡å›­)).*$'
FilterAll: &FilterAll '^(?=.*(.))(?!.*((?i)ç¾¤|é‚€è¯·|è¿”åˆ©|å¾ªç¯|å®˜ç½‘|å®¢æœ|ç½‘ç«™|ç½‘å€|è·å–|è®¢é˜…|æµé‡|åˆ°æœŸ|æœºåœº|ä¸‹æ¬¡|ç‰ˆæœ¬|å®˜å€|å¤‡ç”¨|è¿‡æœŸ|å·²ç”¨|è”ç³»|é‚®ç®±|å·¥å•|è´©å–|é€šçŸ¥|å€’å–|é˜²æ­¢|å›½å†…|åœ°å€|é¢‘é“|æ— æ³•|è¯´æ˜|ä½¿ç”¨|æç¤º|ç‰¹åˆ«|è®¿é—®|æ”¯æŒ|æ•™ç¨‹|å…³æ³¨|æ›´æ–°|ä½œè€…|åŠ å…¥|(\b(USE|USED|TOTAL|EXPIRE|EMAIL|Panel|Channel|Author)\b|(\d{4}-\d{2}-\d{2}|\d+G)))).*$'

# ç­–ç•¥ç»„å‚æ•°é”šç‚¹
# é”šç‚¹ - æ—¶å»¶ä¼˜é€‰å‚æ•° [æ¯ 6 ç§’ä¸€æ¬¡æƒ°æ€§å¥åº·æ£€æŸ¥ï¼Œå®¹å·® 20msï¼Œæ—¶å»¶è¶…è¿‡ 2 ç§’åˆ¤å®šä¸ºå¤±è´¥ï¼Œå¤±è´¥ 3 æ¬¡åˆ™è‡ªåŠ¨è§¦å‘å¥åº·æ£€æŸ¥]
UrlTest: &UrlTest {type: url-test, interval: 99, tolerance: 99, lazy: true, url: 'http://cp.cloudflare.com', disable-udp: false, timeout: 200, max-failed-times: 3, hidden: true, include-all: true}
# é”šç‚¹ - æ•…éšœè½¬ç§»å‚æ•° [æ¯ 6 ç§’ä¸€æ¬¡æƒ°æ€§å¥åº·æ£€æŸ¥ï¼Œæ—¶å»¶è¶…è¿‡ 2 ç§’åˆ¤å®šä¸ºå¤±è´¥ï¼Œå¤±è´¥ 3 æ¬¡åˆ™è‡ªåŠ¨è§¦å‘å¥åº·æ£€æŸ¥]
FallBack: &FallBack {type: fallback, interval: 99, lazy: true, url: 'http://cp.cloudflare.com', disable-udp: false, timeout: 200, max-failed-times: 3, hidden: true, include-all: true}
# é”šç‚¹ - è´Ÿè½½å‡è¡¡å‚æ•° [æ¯ 6 ç§’ä¸€æ¬¡æƒ°æ€§å¥åº·æ£€æŸ¥ï¼Œæ—¶å»¶è¶…è¿‡ 2 ç§’åˆ¤å®šä¸ºå¤±è´¥ï¼Œå¤±è´¥ 3 æ¬¡åˆ™è‡ªåŠ¨è§¦å‘å¥åº·æ£€æŸ¥]
LoadBalance: &LoadBalance {type: load-balance, interval: 99, lazy: true, url: 'http://cp.cloudflare.com', disable-udp: false, strategy: consistent-hashing, timeout: 200, max-failed-times: 3, hidden: true, include-all: true}
# é”šç‚¹ - è§„åˆ™å‚æ•° [æ¯å°æ—¶æ›´æ–°ä¸€æ¬¡è®¢é˜…è§„åˆ™ï¼Œæ›´æ–°è§„åˆ™æ—¶ä½¿ç”¨ç›´è¿ç­–ç•¥]
RuleSet: &RuleSet {type: http, behavior: classical, interval: 3600, format: yaml, proxy: DIRECT}

# ç­–ç•¥ç»„
proxy-groups: 
  - {name: auto, type: url-test, include-all: true, filter: *FilterGame, proxies: [line, select]}
  - {name: url-test, type: url-test, include-all: true, filter: *FilterAll}
  - {name: select, type: select, include-all: true, filter: *FilterAll, proxies: [url-test]}
  - {name: AI, type: url-test, include-all: true, filter: *FilterAll}
  - {name: TikTok, type: url-test, include-all: true, filter: *FilterAll}
  - {name: Telegram, type: url-test, proxies: [Hong Kong, Taiwan, Japan, Korean, New country, US, UK, French, German]}
  - {name: App Store, type: url-test, proxies: [Hong Kong, Taiwan, Japan, Korean, New country, US, UK, French, German]}
  - {name: Apple ID, type: url-test, proxies: [Hong Kong, Taiwan, Japan, Korean, New country, US, UK, French, German]}
  - {name: TestFlight, type: url-test, proxies: [Hong Kong, Taiwan, Japan, Korean, New country, US, UK, French, German]}
  - {name: 1Password, type: url-test, proxies: [Hong Kong, Taiwan, Japan, Korean, New country, US, UK, French, German]}
  - {name: Microsoft, type: url-test, proxies: [Hong Kong, Taiwan, Japan, Korean, New country, US, UK, French, German]}
  - {name: Netflix, type: url-test, proxies: [Hong Kong, Taiwan, Japan, Korean, New country, US, UK, French, German]}
  - {name: Emby, type: url-test, proxies: [Hong Kong, Taiwan, Japan, Korean, New country, US, UK, French, German]}
  - {name: line, type: select, proxies: [Taiwan, Japan, Korean, New country, US, UK, French, German, Hong Kong]}

  - {name: Hong Kong, type: url-test, proxies: [â±Hong Kong, ğŸš¥Hong Kong, ğŸ›Hong Kong]}
  - {name: Taiwan, type: url-test, proxies: [â±Taiwan, ğŸš¥Taiwan, ğŸ›Taiwan]}
  - {name: Japan, type: url-test, proxies: [â±Japan, ğŸš¥Japan, ğŸ›Japan]}
  - {name: Korean, type: url-test, proxies: [â±Korean, ğŸš¥Korean, ğŸ›Korean]}
  - {name: New country, type: url-test, proxies: [â±New country, ğŸš¥New country, ğŸ›New country]}
  - {name: US, type: url-test, proxies: [â±US, ğŸš¥US, ğŸ›US]}
  - {name: UK, type: url-test, proxies: [â±UK, ğŸš¥UK, ğŸ›UK]}
  - {name: French, type: url-test, proxies: [â±French, ğŸš¥French, ğŸ›French]}
  - {name: German, type: url-test, proxies: [â±German, ğŸš¥German, ğŸ›German]}

# æ—¶å»¶ä¼˜é€‰ç­–ç•¥ç»„
  - {name: â±Hong Kong, <<: *UrlTest, filter: *FilterHK}
  - {name: â±Taiwan, <<: *UrlTest, filter: *FilterTW}
  - {name: â±Japan, <<: *UrlTest, filter: *FilterJP}
  - {name: â±Korean, <<: *UrlTest, filter: *FilterKR}
  - {name: â±New country, <<: *UrlTest, filter: *FilterSG}
  - {name: â±US, <<: *UrlTest, filter: *FilterUS}
  - {name: â±UK, <<: *UrlTest, filter: *FilterUK}
  - {name: â±French, <<: *UrlTest, filter: *FilterFR}
  - {name: â±German, <<: *UrlTest, filter: *FilterDE}

# æ•…éšœè½¬ç§»ç­–ç•¥ç»„
  - {name: ğŸš¥Hong Kong, <<: *FallBack, filter: *FilterHK}
  - {name: ğŸš¥Taiwan, <<: *FallBack, filter: *FilterTW}
  - {name: ğŸš¥Japan, <<: *FallBack, filter: *FilterJP}
  - {name: ğŸš¥Korean, <<: *FallBack, filter: *FilterKR}
  - {name: ğŸš¥New country, <<: *FallBack, filter: *FilterSG}
  - {name: ğŸš¥US, <<: *FallBack, filter: *FilterUS}
  - {name: ğŸš¥UK, <<: *FallBack, filter: *FilterUK}
  - {name: ğŸš¥French, <<: *FallBack, filter: *FilterFR}
  - {name: ğŸš¥German, <<: *FallBack, filter: *FilterDE}

  - {name: ğŸ›Hong Kong, <<: *LoadBalance, filter: *FilterHK}
  - {name: ğŸ›Taiwan, <<: *LoadBalance, filter: *FilterTW}
  - {name: ğŸ›Japan, <<: *LoadBalance, filter: *FilterJP}
  - {name: ğŸ›Korean, <<: *LoadBalance, filter: *FilterKR}
  - {name: ğŸ›New country, <<: *LoadBalance, filter: *FilterSG}
  - {name: ğŸ›US, <<: *LoadBalance, filter: *FilterUS}
  - {name: ğŸ›UK, <<: *LoadBalance, filter: *FilterUK}
  - {name: ğŸ›French, <<: *LoadBalance, filter: *FilterFR}
  - {name: ğŸ›German, <<: *LoadBalance, filter: *FilterDE}


rule-providers:
  Proxy:
    <<: *RuleSet
    path: './RuleSet/Proxy.yaml'
    url: 'https://raw.githubusercontent.com/luestr/ProxyResource/main/Tool/Clash/Rule/Proxy.yaml'


rules:
  - RULE-SET, Proxy, auto
  - GEOIP, ir, DIRECT
  - MATCH, auto
